generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id            Int            @id @default(autoincrement())
  username      String         @default(cuid()) @unique
  is_guest       Boolean        @default(false)
  email         String         @unique
  password      String
  avatar_id     Int             @default(1)
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  presentations Presentation[]
  learningProgress LearningProgress[]
  avatar        Avatar        @relation(fields: [avatar_id], references: [id])
}

model Avatar{
  id        Int      @id @default(autoincrement())
  image_url       String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  users     User[]
}

model UserAvatar{
  id Int @id @default(autoincrement())
  user_id Int
  avatar_id Int
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
}

model Learning{
  id            Int            @id @default(autoincrement())
  title         String
  description   String
  video_url     String
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt
  

  learningProgress LearningProgress[]
}

model LearningProgress{
  id            Int            @id @default(autoincrement())
  user_id       Int
  learning_id   Int
  status        LearningStatus @default(LOCKED)
  createdAt     DateTime       @default(now())
  updatedAt     DateTime       @updatedAt

  user          User           @relation(fields: [user_id], references: [id])
  learning      Learning       @relation(fields: [learning_id], references: [id])
}

model Presentation {
  id        Int      @id @default(autoincrement())
  title     String
  user_id    Int     
  video_url String
  createdAt DateTime @default(now())
  updatedAt DateTime @updatedAt
  status    PresentationStatus @default(ONGOING)
  user      User     @relation(fields: [user_id], references: [id])
  questions      Question[]
  feedbacks Feedbacks[] 
}

model Feedbacks {
  id             Int          @id @default(autoincrement())
  presentation_id Int         
  expression     Float     
  intonation     Float         
  posture        Float
  overall_rating String
  suggestion      String?
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt

  presentation   Presentation @relation(fields: [presentation_id], references: [id])
}

model Question {
  id             Int          @id @default(autoincrement())
  presentation_id Int         
  question       String
  createdAt      DateTime     @default(now())
  updatedAt      DateTime     @updatedAt

  presentation   Presentation @relation(fields: [presentation_id], references: [id])
  answers        Answer[]
}

model Answer {
  id          Int      @id @default(autoincrement())
  question_id Int   
  answer      String
  createdAt   DateTime @default(now())
  updatedAt   DateTime @updatedAt
  question    Question      @relation(fields: [question_id], references: [id])
}

enum PresentationStatus {
  ONGOING
  COMPLETED
}

enum LearningStatus{
  LOCKED
  ONPROGRESS
  COMPLETED
}